<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1038px" preserveAspectRatio="none" style="width:836px;height:1038px;background:#FFFFFF;" version="1.1" viewBox="0 0 836 1038" width="836px" zoomAndPan="magnify"><defs><filter height="1" id="b1phl3odemosx60" width="1" x="0" y="0"><feFlood flood-color="#E6E6E6" result="flood"/><feComposite in="SourceGraphic" in2="flood" operator="over"/></filter></defs><g><rect fill="none" height="138.5195" style="stroke:#5D5D5D;stroke-width:1.0;" width="368" x="10" y="102.125"/><rect fill="none" height="341.0137" style="stroke:#5D5D5D;stroke-width:1.0;" width="759" x="10" y="254.6445"/><rect fill="none" height="231.8457" style="stroke:#5D5D5D;stroke-width:1.0;" width="632" x="155" y="609.6582"/><rect fill="none" height="81.5801" style="stroke:#5D5D5D;stroke-width:1.0;" width="675" x="155" y="855.5039"/><line style="stroke:#5D5D5D;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="57" x2="57" y1="85.125" y2="954.084"/><line style="stroke:#5D5D5D;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="192" x2="192" y1="85.125" y2="954.084"/><line style="stroke:#5D5D5D;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="643.5" x2="643.5" y1="85.125" y2="954.084"/><line style="stroke:#5D5D5D;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="782" x2="782" y1="85.125" y2="954.084"/><text fill="#5D5D5D" font-family="&quot;Tahoma&quot;" font-size="16" lengthAdjust="spacing" textLength="68" x="20" y="81.6094">Customer</text><ellipse cx="57" cy="13.5" fill="#FFFFFF" rx="8" ry="8" style="stroke:#5D5D5D;stroke-width:0.5;"/><path d="M57,21.5 L57,48.5 M44,29.5 L70,29.5 M57,48.5 L44,63.5 M57,48.5 L70,63.5 " fill="none" style="stroke:#5D5D5D;stroke-width:0.5;"/><text fill="#5D5D5D" font-family="&quot;Tahoma&quot;" font-size="16" lengthAdjust="spacing" textLength="68" x="20" y="969.6934">Customer</text><ellipse cx="57" cy="981.709" fill="#FFFFFF" rx="8" ry="8" style="stroke:#5D5D5D;stroke-width:0.5;"/><path d="M57,989.709 L57,1016.709 M44,997.709 L70,997.709 M57,1016.709 L44,1031.709 M57,1016.709 L70,1031.709 " fill="none" style="stroke:#5D5D5D;stroke-width:0.5;"/><rect fill="#5D5D5D" height="54.25" rx="2.5" ry="2.5" style="stroke:#5D5D5D;stroke-width:0.5;" width="54" x="165" y="29.875"/><text fill="#FFFFFF" font-family="&quot;Tahoma&quot;" font-size="16" lengthAdjust="spacing" textLength="40" x="172" y="53.4844">Client</text><text fill="#FFFFFF" font-family="&quot;Tahoma&quot;" font-size="16" lengthAdjust="spacing" textLength="29" x="177.5" y="73.6094">App</text><rect fill="#5D5D5D" height="54.25" rx="2.5" ry="2.5" style="stroke:#5D5D5D;stroke-width:0.5;" width="54" x="165" y="953.084"/><text fill="#FFFFFF" font-family="&quot;Tahoma&quot;" font-size="16" lengthAdjust="spacing" textLength="40" x="172" y="976.6934">Client</text><text fill="#FFFFFF" font-family="&quot;Tahoma&quot;" font-size="16" lengthAdjust="spacing" textLength="29" x="177.5" y="996.8184">App</text><rect fill="#5D5D5D" height="54.25" rx="2.5" ry="2.5" style="stroke:#5D5D5D;stroke-width:0.5;" width="71" x="608.5" y="29.875"/><text fill="#FFFFFF" font-family="&quot;Tahoma&quot;" font-size="16" lengthAdjust="spacing" textLength="57" x="615.5" y="53.4844">Farfetch</text><text fill="#FFFFFF" font-family="&quot;Tahoma&quot;" font-size="16" lengthAdjust="spacing" textLength="31" x="628.5" y="73.6094">STS</text><rect fill="#5D5D5D" height="54.25" rx="2.5" ry="2.5" style="stroke:#5D5D5D;stroke-width:0.5;" width="71" x="608.5" y="953.084"/><text fill="#FFFFFF" font-family="&quot;Tahoma&quot;" font-size="16" lengthAdjust="spacing" textLength="57" x="615.5" y="976.6934">Farfetch</text><text fill="#FFFFFF" font-family="&quot;Tahoma&quot;" font-size="16" lengthAdjust="spacing" textLength="31" x="628.5" y="996.8184">STS</text><rect fill="#5D5D5D" height="34.125" rx="2.5" ry="2.5" style="stroke:#5D5D5D;stroke-width:0.5;" width="76" x="744" y="50"/><text fill="#FFFFFF" font-family="&quot;Tahoma&quot;" font-size="16" lengthAdjust="spacing" textLength="62" x="751" y="73.6094">/wishlists</text><rect fill="#5D5D5D" height="34.125" rx="2.5" ry="2.5" style="stroke:#5D5D5D;stroke-width:0.5;" width="76" x="744" y="953.084"/><text fill="#FFFFFF" font-family="&quot;Tahoma&quot;" font-size="16" lengthAdjust="spacing" textLength="62" x="751" y="976.6934">/wishlists</text><path d="M10,102.125 L161,102.125 L161,109.8164 L151,119.8164 L10,119.8164 L10,102.125 " fill="#FFFFFF" style="stroke:#5D5D5D;stroke-width:1.5;"/><rect fill="none" height="138.5195" style="stroke:#5D5D5D;stroke-width:1.0;" width="368" x="10" y="102.125"/><text fill="#5D5D5D" font-family="Tahoma" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="106" x="25" y="116.1313">PKCE generation</text><polygon fill="#5D5D5D" points="180,139.4258,190,143.4258,180,147.4258,184,143.4258" style="stroke:#5D5D5D;stroke-width:1.0;"/><line style="stroke:#5D5D5D;stroke-width:2.0;" x1="57" x2="186" y1="143.4258" y2="143.4258"/><text fill="#5D5D5D" font-family="&quot;Tahoma&quot;" font-size="14" lengthAdjust="spacing" textLength="111" x="64" y="138.3496">Clicks in login link</text><line style="stroke:#5D5D5D;stroke-width:2.0;" x1="192" x2="234" y1="175.0352" y2="175.0352"/><line style="stroke:#5D5D5D;stroke-width:2.0;" x1="234" x2="234" y1="175.0352" y2="188.0352"/><line style="stroke:#5D5D5D;stroke-width:2.0;" x1="193" x2="234" y1="188.0352" y2="188.0352"/><polygon fill="#5D5D5D" points="203,184.0352,193,188.0352,203,192.0352,199,188.0352" style="stroke:#5D5D5D;stroke-width:1.0;"/><text fill="#5D5D5D" font-family="&quot;Tahoma&quot;" font-size="14" lengthAdjust="spacing" textLength="132" x="199" y="169.959">Creates code verifier</text><line style="stroke:#5D5D5D;stroke-width:2.0;" x1="192" x2="234" y1="219.6445" y2="219.6445"/><line style="stroke:#5D5D5D;stroke-width:2.0;" x1="234" x2="234" y1="219.6445" y2="232.6445"/><line style="stroke:#5D5D5D;stroke-width:2.0;" x1="193" x2="234" y1="232.6445" y2="232.6445"/><polygon fill="#5D5D5D" points="203,228.6445,193,232.6445,203,236.6445,199,232.6445" style="stroke:#5D5D5D;stroke-width:1.0;"/><text fill="#5D5D5D" font-family="&quot;Tahoma&quot;" font-size="14" lengthAdjust="spacing" textLength="167" x="199" y="214.5684">Generates code challenge</text><path d="M10,254.6445 L235,254.6445 L235,262.3359 L225,272.3359 L10,272.3359 L10,254.6445 " fill="#FFFFFF" style="stroke:#5D5D5D;stroke-width:1.5;"/><rect fill="none" height="341.0137" style="stroke:#5D5D5D;stroke-width:1.0;" width="759" x="10" y="254.6445"/><text fill="#5D5D5D" font-family="Tahoma" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="180" x="25" y="268.6509">Authorization Code request</text><polygon fill="#5D5D5D" points="632,346.1133,642,350.1133,632,354.1133,636,350.1133" style="stroke:#5D5D5D;stroke-width:1.0;"/><line style="stroke:#5D5D5D;stroke-width:2.0;" x1="192" x2="638" y1="350.1133" y2="350.1133"/><text fill="#5D5D5D" font-family="&quot;Tahoma&quot;" font-size="14" lengthAdjust="spacing" textLength="212" x="199" y="291.5391">Requests Authorization Code with</text><text fill="#5D5D5D" font-family="monospace" font-size="14" lengthAdjust="spacing" textLength="144" x="415" y="290.4111">response_type=code</text><text fill="#5D5D5D" font-family="&quot;Tahoma&quot;" font-size="14" lengthAdjust="spacing" textLength="4" x="559" y="291.5391"> </text><text fill="#5D5D5D" filter="url(#b1phl3odemosx60)" font-family="monospace" font-size="14" lengthAdjust="spacing" textLength="64" x="563" y="290.4111">id_token</text><text fill="#5D5D5D" font-family="&quot;Tahoma&quot;" font-size="14" lengthAdjust="spacing" textLength="284" x="199" y="309.1484">+ transformed code verifier (code_challenge)</text><text fill="#5D5D5D" font-family="&quot;Tahoma&quot;" font-size="14" lengthAdjust="spacing" textLength="154" x="199" y="326.7578">+ transformation method</text><text fill="#5D5D5D" font-family="&quot;Tahoma&quot;" font-size="14" lengthAdjust="spacing" textLength="8" x="199" y="345.0371">+</text><text fill="#5D5D5D" filter="url(#b1phl3odemosx60)" font-family="&quot;Tahoma&quot;" font-size="14" lengthAdjust="spacing" textLength="85" x="211" y="345.0371">openid scope</text><text fill="#5D5D5D" font-family="&quot;Tahoma&quot;" font-size="14" lengthAdjust="spacing" textLength="8" x="300" y="345.0371">+</text><text fill="#5D5D5D" font-family="monospace" font-size="14" lengthAdjust="spacing" textLength="112" x="312" y="343.9092">offline_access</text><polygon fill="#5D5D5D" points="68,378.3926,58,382.3926,68,386.3926,64,382.3926" style="stroke:#5D5D5D;stroke-width:1.0;"/><line style="stroke:#5D5D5D;stroke-width:2.0;stroke-dasharray:2.0,2.0;" x1="62" x2="643" y1="382.3926" y2="382.3926"/><text fill="#5D5D5D" font-family="monospace" font-size="14" lengthAdjust="spacing" textLength="72" x="74" y="376.1885">302 Found</text><text fill="#5D5D5D" font-family="&quot;Tahoma&quot;" font-size="14" lengthAdjust="spacing" textLength="205" x="150" y="377.3164">redirect to authentication prompt</text><polygon fill="#5D5D5D" points="632,427.6113,642,431.6113,632,435.6113,636,431.6113" style="stroke:#5D5D5D;stroke-width:1.0;"/><line style="stroke:#5D5D5D;stroke-width:2.0;" x1="57" x2="638" y1="431.6113" y2="431.6113"/><text fill="#5D5D5D" font-family="&quot;Tahoma&quot;" font-size="14" lengthAdjust="spacing" textLength="146" x="64" y="408.9258">User authenticates with</text><text fill="#5D5D5D" font-family="&quot;Tahoma&quot;" font-size="14" lengthAdjust="spacing" textLength="217" x="64" y="426.5352">username, password, and consent</text><line style="stroke:#5D5D5D;stroke-width:2.0;" x1="644" x2="686" y1="498.4395" y2="498.4395"/><line style="stroke:#5D5D5D;stroke-width:2.0;" x1="686" x2="686" y1="498.4395" y2="511.4395"/><line style="stroke:#5D5D5D;stroke-width:2.0;" x1="645" x2="686" y1="511.4395" y2="511.4395"/><polygon fill="#5D5D5D" points="655,507.4395,645,511.4395,655,515.4395,651,511.4395" style="stroke:#5D5D5D;stroke-width:1.0;"/><text fill="#5D5D5D" font-family="&quot;Tahoma&quot;" font-size="14" lengthAdjust="spacing" textLength="58" x="651" y="458.1445">Validates</text><text fill="#5D5D5D" font-family="&quot;Tahoma&quot;" font-size="14" lengthAdjust="spacing" textLength="106" x="651" y="475.7539">Resource Owner</text><text fill="#5D5D5D" font-family="&quot;Tahoma&quot;" font-size="14" lengthAdjust="spacing" textLength="69" x="651" y="493.3633">credentials</text><polygon fill="#5D5D5D" points="203,539.0488,193,543.0488,203,547.0488,199,543.0488" style="stroke:#5D5D5D;stroke-width:1.0;"/><line style="stroke:#5D5D5D;stroke-width:2.0;stroke-dasharray:2.0,2.0;" x1="197" x2="643" y1="543.0488" y2="543.0488"/><text fill="#5D5D5D" font-family="&quot;Tahoma&quot;" font-size="14" lengthAdjust="spacing" textLength="188" x="209" y="537.9727">Authorization Code Response</text><line style="stroke:#5D5D5D;stroke-width:2.0;" x1="192" x2="234" y1="574.6582" y2="574.6582"/><line style="stroke:#5D5D5D;stroke-width:2.0;" x1="234" x2="234" y1="574.6582" y2="587.6582"/><line style="stroke:#5D5D5D;stroke-width:2.0;" x1="193" x2="234" y1="587.6582" y2="587.6582"/><polygon fill="#5D5D5D" points="203,583.6582,193,587.6582,203,591.6582,199,587.6582" style="stroke:#5D5D5D;stroke-width:1.0;"/><text fill="#5D5D5D" font-family="&quot;Tahoma&quot;" font-size="14" lengthAdjust="spacing" textLength="158" x="199" y="569.582">Validates code challenge</text><path d="M155,609.6582 L343,609.6582 L343,617.3496 L333,627.3496 L155,627.3496 L155,609.6582 " fill="#FFFFFF" style="stroke:#5D5D5D;stroke-width:1.5;"/><rect fill="none" height="231.8457" style="stroke:#5D5D5D;stroke-width:1.0;" width="632" x="155" y="609.6582"/><text fill="#5D5D5D" font-family="Tahoma" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="143" x="170" y="623.6646">Access Token request</text><polygon fill="#5D5D5D" points="632,682.1777,642,686.1777,632,690.1777,636,686.1777" style="stroke:#5D5D5D;stroke-width:1.0;"/><line style="stroke:#5D5D5D;stroke-width:2.0;" x1="192" x2="638" y1="686.1777" y2="686.1777"/><text fill="#5D5D5D" font-family="&quot;Tahoma&quot;" font-size="14" lengthAdjust="spacing" textLength="181" x="199" y="645.8828">Requests Access Token with</text><text fill="#5D5D5D" font-family="&quot;Tahoma&quot;" font-size="14" lengthAdjust="spacing" textLength="240" x="199" y="663.4922">Client Credentials, Authorization Code</text><text fill="#5D5D5D" font-family="&quot;Tahoma&quot;" font-size="14" lengthAdjust="spacing" textLength="106" x="199" y="681.1016">and code verifier</text><line style="stroke:#5D5D5D;stroke-width:2.0;" x1="644" x2="686" y1="770.6152" y2="770.6152"/><line style="stroke:#5D5D5D;stroke-width:2.0;" x1="686" x2="686" y1="770.6152" y2="783.6152"/><line style="stroke:#5D5D5D;stroke-width:2.0;" x1="645" x2="686" y1="783.6152" y2="783.6152"/><polygon fill="#5D5D5D" points="655,779.6152,645,783.6152,655,787.6152,651,783.6152" style="stroke:#5D5D5D;stroke-width:1.0;"/><text fill="#5D5D5D" font-family="&quot;Tahoma&quot;" font-size="14" lengthAdjust="spacing" textLength="58" x="651" y="712.7109">Validates</text><text fill="#5D5D5D" font-family="&quot;Tahoma&quot;" font-size="14" lengthAdjust="spacing" textLength="116" x="651" y="730.3203">Client Credentials,</text><text fill="#5D5D5D" font-family="&quot;Tahoma&quot;" font-size="14" lengthAdjust="spacing" textLength="124" x="651" y="747.9297">Authorization Code,</text><text fill="#5D5D5D" font-family="&quot;Tahoma&quot;" font-size="14" lengthAdjust="spacing" textLength="106" x="651" y="765.5391">and code verifier</text><polygon fill="#5D5D5D" points="203,829.5039,193,833.5039,203,837.5039,199,833.5039" style="stroke:#5D5D5D;stroke-width:1.0;"/><line style="stroke:#5D5D5D;stroke-width:2.0;stroke-dasharray:2.0,2.0;" x1="197" x2="643" y1="833.5039" y2="833.5039"/><text fill="#5D5D5D" font-family="&quot;Tahoma&quot;" font-size="14" lengthAdjust="spacing" textLength="357" x="209" y="810.1484">Access Token Response (and optionally Refresh Token)</text><text fill="#5D5D5D" font-family="&quot;Tahoma&quot;" font-size="14" lengthAdjust="spacing" textLength="8" x="209" y="828.4277">+</text><text fill="#000000" filter="url(#b1phl3odemosx60)" font-family="monospace" font-size="14" lengthAdjust="spacing" textLength="64" x="221" y="827.2998">id_token</text><path d="M155,855.5039 L375,855.5039 L375,863.1953 L365,873.1953 L155,873.1953 L155,855.5039 " fill="#FFFFFF" style="stroke:#5D5D5D;stroke-width:1.5;"/><rect fill="none" height="81.5801" style="stroke:#5D5D5D;stroke-width:1.0;" width="675" x="155" y="855.5039"/><text fill="#5D5D5D" font-family="Tahoma" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="175" x="170" y="869.5103">Protected resource access</text><polygon fill="#5D5D5D" points="770,893.4746,780,897.4746,770,901.4746,774,897.4746" style="stroke:#5D5D5D;stroke-width:1.0;"/><line style="stroke:#5D5D5D;stroke-width:2.0;" x1="192" x2="776" y1="897.4746" y2="897.4746"/><text fill="#5D5D5D" font-family="&quot;Tahoma&quot;" font-size="14" lengthAdjust="spacing" textLength="141" x="199" y="892.3984">Requests Resources (</text><text fill="#5D5D5D" font-family="monospace" font-size="14" lengthAdjust="spacing" textLength="288" x="340" y="891.2705">Authorization: Bearer &lt;access token&gt;</text><text fill="#5D5D5D" font-family="&quot;Tahoma&quot;" font-size="14" lengthAdjust="spacing" textLength="5" x="628" y="892.3984">)</text><polygon fill="#5D5D5D" points="203,925.084,193,929.084,203,933.084,199,929.084" style="stroke:#5D5D5D;stroke-width:1.0;"/><line style="stroke:#5D5D5D;stroke-width:2.0;stroke-dasharray:2.0,2.0;" x1="197" x2="781" y1="929.084" y2="929.084"/><text fill="#5D5D5D" font-family="&quot;Tahoma&quot;" font-size="14" lengthAdjust="spacing" textLength="141" x="209" y="924.0078">Requested Resources</text><!--MD5=[c4ea1a3a0f62ca123a818b5ccde83750]
@startuml
!include diagram-config.puml!tutorial

actor "Customer" as customer
participant "Client\nApp" as partner
participant "Farfetch\nSTS" as farfetch
participant "/wishlists" as resource

group PKCE generation
    customer -> partner: Clicks in login link
    partner -> partner: Creates code verifier
    partner -> partner: Generates code challenge
end
group Authorization Code request
    partner -> farfetch: Requests Authorization Code with ""response_type=code"" <back:#e6e6e6>""id_token""</back>\n+ transformed code verifier (code_challenge)\n+ transformation method\n+ <back:#e6e6e6>openid scope</back> + ""offline_access""
    farfetch - -> customer: ""302 Found"" redirect to authentication prompt
    customer -> farfetch: User authenticates with\nusername, password, and consent
    farfetch -> farfetch: Validates\nResource Owner\ncredentials
    farfetch - -> partner: Authorization Code Response
    partner -> partner: Validates code challenge
end
group Access Token request
    partner -> farfetch: Requests Access Token with\nClient Credentials, Authorization Code\nand code verifier
    farfetch -> farfetch: Validates\nClient Credentials,\nAuthorization Code,\nand code verifier
    farfetch - -> partner: Access Token Response (and optionally Refresh Token)\n+ <back:#e6e6e6><color #000>""id_token""</color></back>
end
group Protected resource access
    partner -> resource: Requests Resources (""Authorization: Bearer <access token>"")
    resource - -> partner: Requested Resources
end
@enduml

@startuml
skinparam shadowing false
skinparam defaultFontName Tahoma

skinparam usecase {
     FontName "Tahoma"
     FontSize 16
     BorderColor #e6e6e6
     BackGroundColor #e6e6e6
     FontColor #5d5d5d
}

skinparam actor  {
    FontName "Tahoma"
    FontSize 16
    FontColor #5d5d5d
    BackGroundColor white
    BorderColor #5d5d5d
    FontName "Tahoma"
}

skinparam participant  {
     FontName "Tahoma"
     FontSize 16
     FontColor #white
     BackGroundColor #5d5d5d
     BorderColor #5d5d5d
}

skinparam rectangle  {
     BorderThickness 1
     Padding 24
     FontName "Tahoma"
     FontSize 16
     FontColor #222222
     BorderColor #b6b6b6
     BackGroundColor #white
}

skinparam State  {
     BorderThickness 1
     Padding 24
     FontName "Tahoma"
     FontSize 16
     FontColor #222222
     BorderColor #b6b6b6
     BackGroundColor #white
}

skinparam Activity  {
     FontName "Tahoma"
     FontSize 14
     BorderColor #e6e6e6
     BackGroundColor #e6e6e6
     FontColor #5d5d5d
}

skinparam ActivityDiamond  {
     BorderThickness 1
     Padding 24
     FontName "Tahoma"
     FontSize 14
     FontColor #222222
     BorderColor #b6b6b6
     BackGroundColor #white
}

skinparam card  {
     FontName "Tahoma"
     FontSize 16
     FontColor #white
     BackGroundColor #5d5d5d
     BorderColor #5d5d5d
}


skinparam agent {
     RoundCorner 40
     FontName "Tahoma"
     FontSize 16
     BorderColor #e6e6e6
     BackGroundColor #e6e6e6
     FontColor #5d5d5d
}

skinparam cloud { 
     FontName "Tahoma"
     FontSize 16    
     FontColor #222222
     BorderColor #b6b6b6
     BackGroundColor #white
}

skinparam Arrow{
    Color #222222
    FontColor #222222
    FontSize 14
    Thickness 1
    FontName "Tahoma"
}

skinparam Line{
    Color #222222
    FontColor #222222
    FontSize 14
    Thickness 1
    FontName "Tahoma"
}

skinparam Sequence {
    ArrowColor #5d5d5d
    ArrowFontColor #5d5d5d
    ArrowFontSize 14
    ArrowThickness 2
    ArrowFontName "Tahoma"
    LineColor #5d5d5d
    LineFontColor #5d5d5d
    LineFontSize 14
    LineThickness 2
    LineFontName "Tahoma"
    LifeLineBackgroundColor #5d5d5d
    LifeLineBorderColor #5d5d5d
    LifeLineBorderThickness 2
    GroupBorderColor #5d5d5d
    GroupBorderThickness 1
    GroupBackgroundColor white
    GroupHeaderFontColor #5d5d5d
}


actor "Customer" as customer
participant "Client\nApp" as partner
participant "Farfetch\nSTS" as farfetch
participant "/wishlists" as resource

group PKCE generation
    customer -> partner: Clicks in login link
    partner -> partner: Creates code verifier
    partner -> partner: Generates code challenge
end
group Authorization Code request
    partner -> farfetch: Requests Authorization Code with ""response_type=code"" <back:#e6e6e6>""id_token""</back>\n+ transformed code verifier (code_challenge)\n+ transformation method\n+ <back:#e6e6e6>openid scope</back> + ""offline_access""
    farfetch - -> customer: ""302 Found"" redirect to authentication prompt
    customer -> farfetch: User authenticates with\nusername, password, and consent
    farfetch -> farfetch: Validates\nResource Owner\ncredentials
    farfetch - -> partner: Authorization Code Response
    partner -> partner: Validates code challenge
end
group Access Token request
    partner -> farfetch: Requests Access Token with\nClient Credentials, Authorization Code\nand code verifier
    farfetch -> farfetch: Validates\nClient Credentials,\nAuthorization Code,\nand code verifier
    farfetch - -> partner: Access Token Response (and optionally Refresh Token)\n+ <back:#e6e6e6><color #000>""id_token""</color></back>
end
group Protected resource access
    partner -> resource: Requests Resources (""Authorization: Bearer <access token>"")
    resource - -> partner: Requested Resources
end
@enduml

PlantUML version 1.2022.7(Mon Aug 22 18:01:30 BST 2022)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: Cp1252
Language: en
Country: US
--></g></svg>